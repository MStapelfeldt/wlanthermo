template:
  - switch:
      - name: wlanthermo_channel_1_push
        availability: >
          {{ not is_state('sensor.wlanthermo_channel_1_all', 'unavailable') }}
        state: >
          {% set temp = state_attr('sensor.wlanthermo_channel_1_all', 'alarm') | int(0) %}
          {{ temp in [1,3] }}
        turn_on:
          service: mqtt.publish
          data:
            topic: WLanThermo/${wlanthermo_model}/set/channels
            retain: true
            payload: >
              {"number":1,"alarm":{{ state_attr('sensor.wlanthermo_channel_1_all', 'alarm') + 1 }}}
        turn_off:
          service: mqtt.publish
          data:
            topic: WLanThermo/${wlanthermo_model}/set/channels
            retain: true
            payload: >
              {"number":1,"alarm":{{ state_attr('sensor.wlanthermo_channel_1_all', 'alarm') - 1 }}}
        icon: >
          {% if is_state('switch.wlanthermo_channel_1_push', 'on') %}
            mdi:message-badge
          {% else %}
            mdi:message-badge-outline
          {% endif %}

      - name: wlanthermo_channel_2_push
        availability: >
          {{ not is_state('sensor.wlanthermo_channel_2_all', 'unavailable') }}
        state: >
          {% set temp = state_attr('sensor.wlanthermo_channel_2_all', 'alarm') | int(0) %}
          {{ temp in [1,3] }}
        turn_on:
          service: mqtt.publish
          data:
            topic: WLanThermo/${wlanthermo_model}/set/channels
            retain: true
            payload: >
              {"number":2,"alarm":{{ state_attr('sensor.wlanthermo_channel_2_all', 'alarm') + 1 }}}
        turn_off:
          service: mqtt.publish
          data:
            topic: WLanThermo/${wlanthermo_model}/set/channels
            retain: true
            payload: >
              {"number":2,"alarm":{{ state_attr('sensor.wlanthermo_channel_2_all', 'alarm') - 1 }}}
        icon: >
          {% if is_state('switch.wlanthermo_channel_2_push', 'on') %}
            mdi:message-badge
          {% else %}
            mdi:message-badge-outline
          {% endif %}

      - name: wlanthermo_channel_3_push
        availability: >
          {{ not is_state('sensor.wlanthermo_channel_3_all', 'unavailable') }}
        state: >
          {% set temp = state_attr('sensor.wlanthermo_channel_3_all', 'alarm') | int(0) %}
          {{ temp in [1,3] }}
        turn_on:
          service: mqtt.publish
          data:
            topic: WLanThermo/${wlanthermo_model}/set/channels
            retain: true
            payload: >
              {"number":3,"alarm":{{ state_attr('sensor.wlanthermo_channel_3_all', 'alarm') + 1 }}}
        turn_off:
          service: mqtt.publish
          data:
            topic: WLanThermo/${wlanthermo_model}/set/channels
            retain: true
            payload: >
              {"number":3,"alarm":{{ state_attr('sensor.wlanthermo_channel_3_all', 'alarm') - 1 }}}
        icon: >
          {% if is_state('switch.wlanthermo_channel_3_push', 'on') %}
            mdi:message-badge
          {% else %}
            mdi:message-badge-outline
          {% endif %}

      - name: wlanthermo_channel_4_push
        availability: >
          {{ not is_state('sensor.wlanthermo_channel_4_all', 'unavailable') }}
        state: >
          {% set temp = state_attr('sensor.wlanthermo_channel_4_all', 'alarm') | int(0) %}
          {{ temp in [1,3] }}
        turn_on:
          service: mqtt.publish
          data:
            topic: WLanThermo/${wlanthermo_model}/set/channels
            retain: true
            payload: >
              {"number":4,"alarm":{{ state_attr('sensor.wlanthermo_channel_4_all', 'alarm') + 1 }}}
        turn_off:
          service: mqtt.publish
          data:
            topic: WLanThermo/${wlanthermo_model}/set/channels
            retain: true
            payload: >
              {"number":4,"alarm":{{ state_attr('sensor.wlanthermo_channel_4_all', 'alarm') - 1 }}}
        icon: >
          {% if is_state('switch.wlanthermo_channel_4_push', 'on') %}
            mdi:message-badge
          {% else %}
            mdi:message-badge-outline
          {% endif %}

      - name: wlanthermo_channel_5_push
        availability: >
          {{ not is_state('sensor.wlanthermo_channel_5_all', 'unavailable') }}
        state: >
          {% set temp = state_attr('sensor.wlanthermo_channel_5_all', 'alarm') | int(0) %}
          {{ temp in [1,3] }}
        turn_on:
          service: mqtt.publish
          data:
            topic: WLanThermo/${wlanthermo_model}/set/channels
            retain: true
            payload: >
              {"number":5,"alarm":{{ state_attr('sensor.wlanthermo_channel_5_all', 'alarm') + 1 }}}
        turn_off:
          service: mqtt.publish
          data:
            topic: WLanThermo/${wlanthermo_model}/set/channels
            retain: true
            payload: >
              {"number":5,"alarm":{{ state_attr('sensor.wlanthermo_channel_5_all', 'alarm') - 1 }}}
        icon: >
          {% if is_state('switch.wlanthermo_channel_5_push', 'on') %}
            mdi:message-badge
          {% else %}
            mdi:message-badge-outline
          {% endif %}

      - name: wlanthermo_channel_6_push
        availability: >
          {{ not is_state('sensor.wlanthermo_channel_6_all', 'unavailable') }}
        state: >
          {% set temp = state_attr('sensor.wlanthermo_channel_6_all', 'alarm') | int(0) %}
          {{ temp in [1,3] }}
        turn_on:
          service: mqtt.publish
          data:
            topic: WLanThermo/${wlanthermo_model}/set/channels
            retain: true
            payload: >
              {"number":6,"alarm":{{ state_attr('sensor.wlanthermo_channel_6_all', 'alarm') + 1 }}}
        turn_off:
          service: mqtt.publish
          data:
            topic: WLanThermo/${wlanthermo_model}/set/channels
            retain: true
            payload: >
              {"number":6,"alarm":{{ state_attr('sensor.wlanthermo_channel_6_all', 'alarm') - 1 }}}
        icon: >
          {% if is_state('switch.wlanthermo_channel_6_push', 'on') %}
            mdi:message-badge
          {% else %}
            mdi:message-badge-outline
          {% endif %}

      - name: wlanthermo_channel_7_push
        availability: >
          {{ not is_state('sensor.wlanthermo_channel_7_all', 'unavailable') }}
        state: >
          {% set temp = state_attr('sensor.wlanthermo_channel_7_all', 'alarm') | int(0) %}
          {{ temp in [1,3] }}
        turn_on:
          service: mqtt.publish
          data:
            topic: WLanThermo/${wlanthermo_model}/set/channels
            retain: true
            payload: >
              {"number":7,"alarm":{{ state_attr('sensor.wlanthermo_channel_7_all', 'alarm') + 1 }}}
        turn_off:
          service: mqtt.publish
          data:
            topic: WLanThermo/${wlanthermo_model}/set/channels
            retain: true
            payload: >
              {"number":7,"alarm":{{ state_attr('sensor.wlanthermo_channel_7_all', 'alarm') - 1 }}}
        icon: >
          {% if is_state('switch.wlanthermo_channel_7_push', 'on') %}
            mdi:message-badge
          {% else %}
            mdi:message-badge-outline
          {% endif %}

      - name: wlanthermo_channel_8_push
        availability: >
          {{ not is_state('sensor.wlanthermo_channel_8_all', 'unavailable') }}
        state: >
          {% set temp = state_attr('sensor.wlanthermo_channel_8_all', 'alarm') | int(0) %}
          {{ temp in [1,3] }}
        turn_on:
          service: mqtt.publish
          data:
            topic: WLanThermo/${wlanthermo_model}/set/channels
            retain: true
            payload: >
              {"number":8,"alarm":{{ state_attr('sensor.wlanthermo_channel_8_all', 'alarm') + 1 }}}
        turn_off:
          service: mqtt.publish
          data:
            topic: WLanThermo/${wlanthermo_model}/set/channels
            retain: true
            payload: >
              {"number":8,"alarm":{{ state_attr('sensor.wlanthermo_channel_8_all', 'alarm') - 1 }}}
        icon: >
          {% if is_state('switch.wlanthermo_channel_8_push', 'on') %}
            mdi:message-badge
          {% else %}
            mdi:message-badge-outline
          {% endif %}

      - name: wlanthermo_channel_9_push
        availability: >
          {{ not is_state('sensor.wlanthermo_channel_9_all', 'unavailable') }}
        state: >
          {% set temp = state_attr('sensor.wlanthermo_channel_9_all', 'alarm') | int(0) %}
          {{ temp in [1,3] }}
        turn_on:
          service: mqtt.publish
          data:
            topic: WLanThermo/${wlanthermo_model}/set/channels
            retain: true
            payload: >
              {"number":9,"alarm":{{ state_attr('sensor.wlanthermo_channel_9_all', 'alarm') + 1 }}}
        turn_off:
          service: mqtt.publish
          data:
            topic: WLanThermo/${wlanthermo_model}/set/channels
            retain: true
            payload: >
              {"number":9,"alarm":{{ state_attr('sensor.wlanthermo_channel_9_all', 'alarm') - 1 }}}
        icon: >
          {% if is_state('switch.wlanthermo_channel_9_push', 'on') %}
            mdi:message-badge
          {% else %}
            mdi:message-badge-outline
          {% endif %}
